# dursor UI/UX 改善計画 v2

このドキュメントは、dursorの現在のフロントエンド実装（Next.js + Tailwind CSS）に基づき、UI/UXの観点からさらなる改善点をまとめたものです。
基本的なUIコンポーネント（Button, Input, Toastなど）は整備されつつありますが、ユーザー体験をより向上させるための高度な改善点に焦点を当てています。

## 目次

1. [現状分析](#現状分析)
2. [主要な改善エリア](#主要な改善エリア)
   - [ナビゲーションと情報構造](#ナビゲーションと情報構造)
   - [チャットとインタラクション](#チャットとインタラクション)
   - [実行結果の管理と可視化](#実行結果の管理と可視化)
   - [設定とオンボーディング](#設定とオンボーディング)
3. [デザインとアクセシビリティ](#デザインとアクセシビリティ)
4. [実装ロードマップ](#実装ロードマップ)

---

## 現状分析

現在の`apps/web`の実装状況を確認すると、以下のような特徴があります。

*   **基盤**: Next.js App Router, Tailwind CSS, Heroiconsを採用。
*   **コンポーネント**: `components/ui`ディレクトリに基本的なUIパーツ（Button, Input, Modal, Toast, Skeleton）が実装済み。
*   **状態管理**: SWRを使用したデータフェッチとキャッシュ管理。
*   **課題**: 基本的な機能は動作しているが、データ量が増えた際のスケーラビリティ（タスク一覧や実行ログ）、インタラクションの滑らかさ、モバイル対応、キーボード操作の網羅性に改善の余地があります。

## 主要な改善エリア

### ナビゲーションと情報構造

#### 1. サイドバーの機能強化 (`Sidebar.tsx`)
現在のサイドバーは単純なタスクリストですが、タスク数が増加すると目的のタスクを見つけるのが困難になります。

*   **検索・フィルタリング機能**: タスク名による検索、日付でのグルーピング（「今日」「昨日」「過去7日間」など）を追加。
*   **タスクのメタデータ表示**: ステータス（進行中、完了など）や使用したモデルのアイコンをリストアイテムに表示し、一覧性を向上。
*   **レスポンシブ対応**: モバイル画面ではハンバーガーメニューに収納し、オーバーレイ表示にする実装が必要です（現状は画面幅によっては使いづらい可能性があります）。

#### 2. ホーム画面の整理 (`app/page.tsx`)
タスク作成フローにおいて、リポジトリ選択やブランチ選択が重要ですが、初心者には少し複雑に見える可能性があります。

*   **ステップバイステップUI**: 必須項目（リポジトリ選択）を先に完了させてから、詳細設定（ブランチ、モデル選択）を表示するような段階的なUIを検討。
*   **最近使用したリポジトリ**: 履歴から素早く選択できる「最近使ったリポジトリ」セクションの追加。

### チャットとインタラクション

#### 1. チャット体験の向上 (`ChatPanel.tsx`, `ChatCodeView.tsx`)
チャットインターフェースはアプリケーションの中心です。よりスムーズな対話体験を目指します。

*   **入力エリアの改善**:
    *   **リッチテキスト入力**: コードブロックの貼り付けや、メンション機能（`@`でファイル参照など）のサポート。
    *   **送信ボタンの状態**: 入力が空の場合は無効化されていますが、なぜ無効なのかわかるようなツールチップやスタイル調整。
*   **フィードバックの強化**:
    *   **楽観的UI (Optimistic UI)**: メッセージ送信時、サーバーレスポンスを待たずに即座にUIに反映し、バックグラウンドで同期することで体感速度を向上。
    *   **タイピングインジケータ**: モデルが応答を生成している間の「考え中...」のような視覚的フィードバックを強化。

#### 2. モデル選択の改善
`ChatPanel`内のモデル選択は現在ボタンの羅列ですが、モデル数が増えると管理が難しくなります。

*   **グループ化**: プロバイダー（OpenAI, Anthropic, Google）ごとにグループ化して表示。
*   **プリセット機能**: よく使うモデルの組み合わせ（「高速セット」「高品質セット」など）を保存・呼び出しできる機能。

### 実行結果の管理と可視化

#### 1. RunsPanelの視認性向上 (`RunsPanel.tsx`)
並列実行の結果を効率的に確認するための改善です。

*   **ステータスの可視化**: 成功/失敗だけでなく、実行時間やコスト（トークン数など）の目安を表示。
*   **詳細ログへのアクセス**: クリックしなくても、ホバーでエラーの要約を表示するなど、少ないクリック数で情報を得られる工夫。
*   **フィルタリング**: 「失敗した実行のみ表示」「特定のモデルのみ表示」などのフィルター機能。

#### 2. DiffViewerの操作性
パッチ適用結果のDiffは見づらくなることがあります。

*   **表示モード切替**: Split（左右分割）表示とUnified（行内）表示の切り替え機能。
*   **シンタックスハイライト**: 変更箇所の言語に応じた適切なハイライト。

### 設定とオンボーディング

#### 1. 初期設定ウィザード
初めてユーザーがアクセスした際、APIキーの設定やGithub連携をスムーズに行えるウィザード画面を導入します。現在は設定画面を開く必要がありますが、タスク作成前に必要な設定を案内するフローが望ましいです。

#### 2. APIキー管理のUX (`SettingsModal.tsx`)
*   **検証機能**: APIキーを入力した際、保存前に「テスト接続」を行えるボタンを追加し、キーが有効かどうか即座に確認できるようにする。
*   **セキュリティ表示**: 入力済みのキーは伏せ字で表示し、編集時のみ再入力を求める形にする。

---

## デザインとアクセシビリティ

### デザインシステムの洗練
既存の `globals.css` と `tailwind.config.js` を拡張し、一貫性を強化します。

*   **タイポグラフィ**: 見出し、本文、コード、キャプションのフォントサイズと行間のルールを明確化。
*   **配色**: 現在のダークモードに加え、コンポーネントの境界や階層を明確にするための「Surface」カラーの定義（`bg-gray-800`だけでなく、より細かい階層）。
*   **マイクロインタラクション**: ボタンのホバー、クリック、モーダルの出現時などに、控えめだが心地よいアニメーション（`framer-motion`などの導入検討）を追加。

### アクセシビリティ (a11y)
*   **キーボードナビゲーション**:
    *   `Tab`キーでのフォーカス移動順序の最適化。
    *   カスタムドロップダウンやモーダルにおける `Escape` キーでの閉じる動作、矢印キーでの選択移動の完全対応。
*   **スクリーンリーダー対応**:
    *   アイコンボタンへの `aria-label` の徹底。
    *   動的なコンテンツ更新（チャットの着信など）に対する `aria-live` 属性の活用。

---

## 実装ロードマップ

### Phase 1: クイックウィン（即効性のある改善）
1.  **RunsPanelのフィルタリング**: 成功/失敗でのフィルタリング機能追加。
2.  **サイドバーのレスポンシブ対応**: モバイルでの表示崩れ修正。
3.  **キーボードショートカット**: `Ctrl/Cmd + Enter` 以外のショートカット（例: `Esc`で入力クリア、`/`で入力欄フォーカス）の追加。

### Phase 2: コア体験の向上
1.  **チャット入力の強化**: ファイル添付（プレースホルダーだけでなく実装）やメンション機能。
2.  **DiffViewerの改善**: Split/Unified表示切り替え。
3.  **モデル選択UIの刷新**: グループ化とプリセット機能。

### Phase 3: 基盤整備と高度な機能
1.  **検索機能の実装**: タスク、メッセージの全文検索。
2.  **設定ウィザード**: 初回ユーザー向けのオンボーディングフロー。
3.  **アクセシビリティ監査**: Lighthouse等を用いたスコア改善とARIA属性の整備。
